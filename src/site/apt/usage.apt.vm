~~ NOTE: For help with the syntax of this file, see:
~~ http://maven.apache.org/doxia/references/apt-format.html

Usage

 The <<<testlab:publish>>> goal provided by this plugin is used to push testing results parsed
 from xUnit-compatible .xml files or Robot Framework's output.xml file to Meliora Testlab as testing results.

 Some common points must be taken in account when using this plugin:

 * The results are parsed from xUnit-compatible reports (.xml-files) such as generated by the surefire plugin.

 * You must configure your project in a way that the failed tests won't halt the execution as FAILURE. Otherwise,
 this plugin won't run. For example, with surefire, you can configure maven-surefire-plugin with

+----------+
...
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <configuration>
                <testFailureIgnore>true</testFailureIgnore>
                ...
            </configuration>
        </plugin>
        ...
    </plugins>
...
+----------+

 * When format is "junit": The goal can be configured with multiple directories and patterns from where the .xml files
 generated during the build are scanned from. This way, you can publish multiple results with a
 single invocation.

 * When format is "robot": The goal should be configured with a pattern matching single output.xml generated by
 Robot Framework.

 * The goal should be run after all the goals generating testing results have run. Typically,
  <<<publish>>> goal in <<<verify>>> phase might do the trick.

*Example: complete configuration

 A complete surefire-based configuration block for the plugin is as follows:

+----------+
...
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <configuration>
                    <!-- ignore failure here to allow other plugins to run -->
                    <testFailureIgnore>true</testFailureIgnore>
                </configuration>
            </plugin>
            <plugin>
                <groupId>fi.meliora</groupId>
                <artifactId>testlab-maven-plugin</artifactId>
                <version>1.0</version>
                <configuration>
                    <companyId>mycompany</companyId>
                    <apiKey>mytopsecretapikey</apiKey>
                    <!-- or, if you are using Testlab on-premise -->
                    <!-- onpremiseUrl>http://testlab.mycompany.com:8080</onpremiseUrl -->
                    <testCaseMappingField>Automated</testCaseMappingField>
                    <projectKey>TLABDEMO</projectKey>
                    <testRun>Integration tests</testRun>
                    <testRunUser>Maven</testRunUser>
                    <testRunComment>Integration tests run for ${project.version} at  ${maven.build.timestamp}</testRunComment>
                    <milestone>M1</milestone>
                    <version>${project.version}</version>
                    <testEnvironment>system-testing</testEnvironment>
                    <tags>
                        <tag>maven</tag>
                        <tag>automated</tag>
                        <tag>integration</tag>
                    </tags>
                    <parameters>
                        <UI>Desktop</UI>
                        <BROWSER>Firefox</BROWSER>
                    </parameters>
                    <addIssues>true</addIssues>
                    <assignIssuesToUser>agentsmith</assignIssuesToUser>
                    <reopenExistingIssues>true</reopenExistingIssues>
                    <mergeAsSingleIssue>true</mergeAsSingleIssue>
                    <importTestCases>true</importTestCases>
                    <importTestCasesRootCategory>Automated/Import</importTestCasesRootCategory>
                    <format>junit</format>
                    <resources>
                        <resource>
                            <directory>target/surefire-reports</directory>
                            <includes>
                                <include>**/*.xml</include>
                            </includes>
                            <!-- excludes>
                                <exclude>**/junk/**</exclude>
                            </excludes -->
                        </resource>
                    </resources>
                    <forcePublish>false</forcePublish>
                    <ignoreFailedTests>false</ignoreFailedTests>
                </configuration>
                <executions>
                    <execution>
                        <phase>verify</phase>
                        <goals>
                            <goal>publish</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            ...
        </plugins>
    </build>
...
+----------+

 The above will run all tests with surefire-plugin and publish the results

 * to hosted Testlab with company identifier mycompany (mycompany.melioratestlabcom),

 * using "mytopsecretapikey" as API key for authentication,

 * by mapping the automated tests to test cases with custom field named "Automated",

 * to Testlab project TLABDEMO,

 * to test run titled "Integration tests",

 * by setting the test run's creator as "Maven",

 * by setting the test run's comment field as "Integration tests run for [build version] at [timestamp]",

 * by targeting milestone "M1" in Testlab,

 * by setting the version field in testrun to match the POM's version,

 * by setting the environment as "system-testing",

 * by tagging the test run with tags "maven", "automated" and "integration",

 * by setting the test case parameters in Testlab as UI = Desktop and BROWSER = Firefox,

 * with adding issues to Testlab for any failed tests,

 * by assigning all the issues to user "agentsmith",

 * by reopening existing matching issues in Testlab if found,

 * by merging all testing failures to a single issue,

 * by automatically adding missing test cases (== missing by mapping identifier constructed) to Testlab project,

 * by adding the missing test cases to test category Automated / Import,

 * by setting the format of tests published as "junit",

 * by looking for the xUnit .xml files from target/surefire-reports path,

 * by honoring the -Dtest and -Dit.test properties so that if either one is set the results are not published,

 * by marking the build as failed if any failures or errors are present in result files configured and

 * running the plugin in <<<publish>>> goal in <<<verify>>> phase.

*Example: minimal configuration

 A minimal surefire-based configuration block for the plugin is as follows:

+----------+
...
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <configuration>
                    <testFailureIgnore>true</testFailureIgnore>
                </configuration>
            </plugin>
            <plugin>
                <groupId>fi.meliora</groupId>
                <artifactId>testlab-maven-plugin</artifactId>
                <version>1.0</version>
                <configuration>
                    <companyId>mycompany</companyId>
                    <apiKey>mytopsecretapikey</apiKey>
                    <testCaseMappingField>Automated</testCaseMappingField>
                    <projectKey>TLABDEMO</projectKey>
                    <testRun>Integration tests</testRun>
                    <resources>
                        <resource>
                            <directory>target/surefire-reports</directory>
                            <includes>
                                <include>**/*.xml</include>
                            </includes>
                        </resource>
                    </resources>
                </configuration>
                <executions>
                    <execution>
                        <phase>verify</phase>
                        <goals>
                            <goal>publish</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            ...
        </plugins>
    </build>
...
+----------+

 The above will run all tests with surefire-plugin and publish the results

 * to hosted Testlab with company identifier mycompany (mycompany.melioratestlabcom),

 * using "mytopsecretapikey" as API key for authentication,

 * by mapping the automated tests to test cases with custom field named "Automated",

 * to Testlab project TLABDEMO,

 * to test run titled "Integration tests",

 * by looking for the xUnit .xml files from target/surefire-reports path (default format is "junit") and

 * running the plugin in <<<publish>>> goal in <<<verify>>> phase.

*Example: On-premise Testlab

+----------+
...
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <configuration>
                    <testFailureIgnore>true</testFailureIgnore>
                </configuration>
            </plugin>
            <plugin>
                <groupId>fi.meliora</groupId>
                <artifactId>testlab-maven-plugin</artifactId>
                <version>1.0</version>
                <configuration>
                    <onpremiseUrl>http://testlab.mycompany.com:8080</onpremiseUrl>
                    <apiKey>mytopsecretapikey</apiKey>
                    <testCaseMappingField>Automated</testCaseMappingField>
                    <projectKey>TLABDEMO</projectKey>
                    <testRun>Integration tests</testRun>
                    <resources>
                        <resource>
                            <directory>target/surefire-reports</directory>
                            <includes>
                                <include>**/*.xml</include>
                            </includes>
                        </resource>
                    </resources>
                </configuration>
                <executions>
                    <execution>
                        <phase>verify</phase>
                        <goals>
                            <goal>publish</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            ...
        </plugins>
    </build>
...
+----------+

 The above will run all tests with surefire-plugin and publish the results

 * to Testlab running at http://testlab.mycompany.com:8080,

 * using "mytopsecretapikey" as API key for authentication,

 * by mapping the automated tests to test cases with custom field named "Automated",

 * to Testlab project TLABDEMO,

 * to test run titled "Integration tests",

 * by looking for the xUnit .xml files from target/surefire-reports path and

 * running the plugin in <<<publish>>> goal in <<<verify>>> phase.
